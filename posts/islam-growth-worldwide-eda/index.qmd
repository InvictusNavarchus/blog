---
title: EDA on islam religion growth worldwide
description: Exploring World Religion dataset to uncover the growth of Islam in various countries using R
date: 2024-08-14:06:08:00
categories: [EDA, R]
image: mosque.png
---

## Setup

```{r}
library(tidyverse)
library(visdat)
library(DataExplorer)
library(naniar)
library(janitor)
library(validate)
library(countrycode)
```

```{r}
df <- read_csv('./ThrowbackDataThursday 201912 - Religion.csv')
```

## Inspect Dataset

```{r}
df
```

```{r}
df |> str()
```

## Clean Data

### Pick relevant columns

```{r}
df_islam <- df |> 
  select(Country = StateNme, Year, starts_with('Islam'))

df_islam
```

### Check Data type

```{r}
df_islam |> 
  str()
```

#### Fix Data Types

```{r}
df_islam_correct_type <- df_islam |> 
  mutate(Country = as_factor(Country))
```

### Check Duplicate

```{r}
df_islam_correct_type |> names()
```

#### Check duplicate Year

```{r}
df_islam_correct_type |> 
  get_dupes() |> 
  relocate(dupe_count)
```

```{r}
df_islam_correct_type |>
  count(Year, Country) |> 
  arrange(desc(n)) |> 
  count(n)
```

#### Remove duplicate using distinct()

```{r}
df_islam |> 
  nrow()
```

```{r}
df_islam_correct_type |> 
  distinct() |> 
  nrow()
```

```{r}
df_islam_removedduplicate <- df_islam_correct_type |> 
  distinct()
```

### Check Missing Value

```{r}
df_islam_removedduplicate |> 
  vis_miss()
```

```{r}
df_islam_replacedna <- df_islam_removedduplicate |> 
  mutate(across(everything(), function(x) replace_na(x, 0)))

df_islam_replacedna |> 
  vis_miss()
```

#### Check Zero Distribution (Possible Null Value)

```{r}
df_islam_replacedna |>
  select(!Country) |> 
  vis_expect(function(x) x != 0)
```
#### Replace zero with NA

```{r}
df_islam_replacedzero <- df_islam_replacedna |> 
  mutate(across(everything(), function(x) if_else(x == 0, NA, x)))
```

### Check Missing Value (Second Stage)

```{r}
df_islam_replacedzero |> 
  miss_var_summary()
```


```{r}
df_islam_replacedzero |> 
  gg_miss_var()
```

```{r}
df_islam_replacedzero
```


```{r}
df_islam_replacedzero |> 
  gg_miss_upset()
```

### Check Data Constrains

#### Check Country Names

```{r}
valid_countries <- codelist$country.name.en

validation_rules_country <- validator(
  Country %in% valid_countries
)

cf_country <- confront(df_islam_replacedzero, validation_rules_country)

```

```{r}
summary(cf_country)
```
```{r}
violating(df_islam_replacedzero, validation_rules_country) |> 
  distinct(Country)
```




#### Check Integers

```{r}
validation_rules_integer <- validator(
  `Islam - Sunni (Population)` %% 1 == 0,
  `Islam - Shi'a (Population)` %% 1 == 0,
  `Islam - Ibadhi (Population)` %% 1 == 0,
  `Islam - Nation of Islam (Population)` %% 1 == 0,
  `Islam - Alawite (Population)` %% 1 == 0,
  `Islam - Ahmadiyya (Population)` %% 1 == 0,
  `Islam - Others (Population)` %% 1 == 0,
  `Islam - Total (Population)` %% 1 == 0
)
cf_integer <- confront(df_islam_replacedzero, validation_rules_integer)
summary(cf_integer)
```
#### Check Decimals

```{r}
validation_rules_decimal <- validator(
  `Islam - Sunni (Percent)` %% 1 > 0,
  `Islam - Shi'a (Percent)` %% 1 > 0,
  `Islam - Ibadhi (Percent)` %% 1 > 0,
  `Islam - Nation of Islam (Percent)` %% 1 > 0,
  `Islam - Alawite (Percent)` %% 1 > 0,
  `Islam - Ahmadiyya (Percent)` %% 1 > 0,
  `Islam - Others (Percent)` %% 1 > 0,
  `Islam - Total (Percent)` %% 1 > 0
)

cf_decimal <- confront(df_islam_replacedzero, validation_rules_decimal)
summary(cf_decimal)
```


### Check Distribution

#### Overview

```{r}
df_islam_replacedzero |> 
  select(contains('Population')) |> 
  plot_histogram(ncol = 1)
```

#### Year

```{r}
df_islam_replacedzero |> 
  ggplot(aes(Year)) +
  geom_line(stat = 'count') + 
  geom_point(stat='count') +
  scale_x_continuous(breaks = seq(1945, 2010, by=5))
```


#### Country

```{r}
df_islam_replacedzero |> 
  distinct(Country) |> 
  nrow()
```


```{r}
df_islam_year_data <- df_islam_replacedzero |> 
  count(Country) |> 
  count(n) |> 
  arrange(desc(nn)) |> 
  rename('Year Data Availibility' = n, 'Total Country' = nn)

df_islam_year_data |> 
  ggplot(aes(`Year Data Availibility`, `Total Country`)) +
  geom_col() +
  scale_x_continuous(breaks = seq(1:14))
```

